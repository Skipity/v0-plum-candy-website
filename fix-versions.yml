name: Enforce Correct Package Versions

on:
  push:
    branches:
      - main

jobs:
  fix-and-commit:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Check for and fix incorrect Tailwind versions
        run: |
          # The ".*" is a wildcard. It will match ANY incorrect version string.
          sed -i 's/"tailwindcss": ".*"/"tailwindcss": "^4.1.9"/' package.json
          sed -i 's/"@tailwindcss/vite": ".*"/"@tailwindcss/vite": "^4.1.4"/' package.json
          echo "Checked and fixed versions if necessary."

      - name: Commit and push changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "CI: Auto-correct Tailwind versions downgraded by v0"
          branch: main
          file_pattern: package.json
